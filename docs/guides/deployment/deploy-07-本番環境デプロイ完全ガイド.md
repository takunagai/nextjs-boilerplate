# Cloudflare Workers æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤å®Œå…¨ã‚¬ã‚¤ãƒ‰

> **å¯¾è±¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: Next.js 15 ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆ
> **ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆ**: Cloudflare Workers
> **ãƒ‰ãƒ¡ã‚¤ãƒ³**: ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ (ä¾‹: nagai-shouten.com)
> **æœ€çµ‚æ›´æ–°**: 2026-01-08

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [å‰ææ¡ä»¶](#å‰ææ¡ä»¶)
3. [ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †](#ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †)
4. [ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š](#ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š)
5. [å‹•ä½œç¢ºèª](#å‹•ä½œç¢ºèª)
6. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
7. [è£œè¶³æƒ…å ±](#è£œè¶³æƒ…å ±)

---

## æ¦‚è¦

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€Next.js 15 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ Cloudflare Workers ã«æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã—ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¨­å®šã™ã‚‹æ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚

### ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ•ãƒ­ãƒ¼

```mermaid
graph LR
    A[Workeråè¨­å®š] --> B[èªè¨¼ç¢ºèª]
    B --> C[ç’°å¢ƒå¤‰æ•°è¨­å®š]
    C --> D[ãƒ“ãƒ«ãƒ‰&ãƒ‡ãƒ—ãƒ­ã‚¤]
    D --> E[ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š]
    E --> F[å‹•ä½œç¢ºèª]
```

---

## å‰ææ¡ä»¶

### å¿…é ˆè¦ä»¶

- [x] Cloudflare ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆæ¸ˆã¿
- [x] Cloudflare Registrar ã§ãƒ‰ãƒ¡ã‚¤ãƒ³å–å¾—æ¸ˆã¿ï¼ˆã¾ãŸã¯ãƒ‰ãƒ¡ã‚¤ãƒ³ç§»ç®¡æ¸ˆã¿ï¼‰
- [x] Node.js 18.x ä»¥ä¸Šã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- [x] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã« `@opennextjs/cloudflare` è¨­å®šæ¸ˆã¿

### ç¢ºèªäº‹é …

```bash
# Node.js ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
node -v
# v18.x ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨

# wrangler ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
wrangler --version
# v4.x ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨

# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§å®Ÿè¡Œ
ls wrangler.toml open-next.config.ts
# ä¸¡ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã“ã¨
```

---

## ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### Step 1: Worker åã®è¨­å®š

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã® Worker åã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¾ã™ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«**: `wrangler.toml`

```diff
- name = "nextjs-boilerplate"
+ name = "nagai-shouten"
```

> **ğŸ’¡ Tips**: Worker åã¯ãƒ‰ãƒ¡ã‚¤ãƒ³åã¨åˆã‚ã›ã‚‹ã¨ç®¡ç†ã—ã‚„ã™ã„ã§ã™ã€‚

---

### Step 2: èªè¨¼ç¢ºèª

Cloudflare CLI ã®èªè¨¼çŠ¶æ…‹ã‚’ç¢ºèªã—ã¾ã™ã€‚

```bash
wrangler whoami
```

#### å‡ºåŠ›ä¾‹ï¼ˆèªè¨¼æ¸ˆã¿ï¼‰

```
ğŸ‘‹ You are logged in with an User API Token, associated with the email you@example.com.
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Account Name      â”‚ Account ID                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ nagai-shouten.com â”‚ 20d0f1d15393a71d8e2d2a056c2d294d â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æœªèªè¨¼ã®å ´åˆ

```bash
wrangler login
```

ãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ãã€Cloudflare ã«ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™ã€‚èªè¨¼å®Œäº†å¾Œã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«æˆ»ã‚Šã¾ã™ã€‚

---

### Step 3: ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

Auth.js (NextAuth) ã§ä½¿ç”¨ã™ã‚‹ç§˜å¯†éµã‚’è¨­å®šã—ã¾ã™ã€‚

#### 3.1 AUTH_SECRET ã®ç”Ÿæˆ

```bash
openssl rand -base64 32
```

**å‡ºåŠ›ä¾‹**:
```
Ykxr2T27E6r/JNvstjJIL7mCylzUw+aBd/mdnAnRMqo=
```

> **âš ï¸ é‡è¦**: ã“ã®å€¤ã¯ä¸€åº¦ã—ã‹è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚å¿…ãšãƒ¡ãƒ¢ã—ã¦ãã ã•ã„ã€‚

#### 3.2 Cloudflare Workers ã«ç§˜å¯†éµã‚’è¨­å®š

```bash
# AUTH_SECRET ã‚’æœ¬ç•ªç’°å¢ƒã«è¨­å®š
wrangler secret put AUTH_SECRET --env production
```

ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€ç”Ÿæˆã—ãŸå€¤ã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ï¼š

```
Enter a secret value: â€º Ykxr2T27E6r/JNvstjJIL7mCylzUw+aBd/mdnAnRMqo=
âœ¨ Success! Uploaded secret AUTH_SECRET
```

#### 3.3 AUTH_URL ã®è¨­å®š

```bash
# AUTH_URL ã‚’æœ¬ç•ªç’°å¢ƒã«è¨­å®š
wrangler secret put AUTH_URL --env production
```

ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã® URL ã‚’å…¥åŠ›ã—ã¾ã™ï¼š

```
Enter a secret value: â€º https://nagai-shouten.com
âœ¨ Success! Uploaded secret AUTH_URL
```

#### 3.4 è¨­å®šç¢ºèª

```bash
# è¨­å®šã•ã‚ŒãŸç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
wrangler secret list --env production
```

**å‡ºåŠ›ä¾‹**:
```
[
  {
    "name": "AUTH_SECRET",
    "type": "secret_text"
  },
  {
    "name": "AUTH_URL",
    "type": "secret_text"
  }
]
```

---

### Step 4: ãƒ“ãƒ«ãƒ‰ & ãƒ‡ãƒ—ãƒ­ã‚¤

#### 4.1 åˆå›ãƒ‡ãƒ—ãƒ­ã‚¤å‰ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—

æ—¢å­˜ã®ãƒ“ãƒ«ãƒ‰æˆæœç‰©ãŒã‚ã‚‹å ´åˆã¯å‰Šé™¤ã—ã¾ã™ï¼š

```bash
# æ—¢å­˜ã® .open-next ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å‰Šé™¤
rm -rf .open-next .next
```

#### 4.2 ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ

```bash
npm run deploy:production
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ä»¥ä¸‹ã‚’é †æ¬¡å®Ÿè¡Œã—ã¾ã™ï¼š

1. **`npm run build`**: Next.js ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ“ãƒ«ãƒ‰
2. **`opennextjs-cloudflare build`**: Cloudflare Workers ç”¨ã«å¤‰æ›
3. **`wrangler deploy --env production`**: Cloudflare Workers ã«ãƒ‡ãƒ—ãƒ­ã‚¤

#### 4.3 ãƒ‡ãƒ—ãƒ­ã‚¤å‡ºåŠ›ä¾‹

```
âœ¨ Build completed successfully
ğŸ“¦ Deploying to Cloudflare Workers...
âœ… Total Upload: 2.2 MB / gzip: 482 KB
âœ¨ Success! Published to https://nagai-shouten.nagai-shouten.workers.dev
```

> **â±ï¸ æ‰€è¦æ™‚é–“**: åˆå›ãƒ‡ãƒ—ãƒ­ã‚¤ã¯ 2ã€œ5 åˆ†ç¨‹åº¦ã‹ã‹ã‚Šã¾ã™ã€‚

---

## ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š

Worker ã‚’ç‹¬è‡ªãƒ‰ãƒ¡ã‚¤ãƒ³ã§å…¬é–‹ã—ã¾ã™ã€‚

### Step 5: Cloudflare Dashboard ã§ãƒ‰ãƒ¡ã‚¤ãƒ³è¿½åŠ 

#### 5.1 Workers & Pages ã‚’é–‹ã

1. [Cloudflare Dashboard](https://dash.cloudflare.com) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. å·¦å´ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ **ã€ŒWorkers & Pagesã€** ã‚’é¸æŠ
3. ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸ **`nagai-shouten`** Worker ã‚’ã‚¯ãƒªãƒƒã‚¯

#### 5.2 ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¿½åŠ 

1. **ã€Œè¨­å®šã€** ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯
2. **ã€Œãƒˆãƒªã‚¬ãƒ¼ã€** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¾ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
3. **ã€Œã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã€** ã® **ã€Œã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¿½åŠ ã€** ã‚’ã‚¯ãƒªãƒƒã‚¯

![Cloudflare ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¿½åŠ ç”»é¢](https://via.placeholder.com/800x400?text=Cloudflare+Dashboard+Screenshot)

4. ãƒ‰ãƒ¡ã‚¤ãƒ³å…¥åŠ›æ¬„ã« **`nagai-shouten.com`** ã‚’å…¥åŠ›
5. **ã€Œãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¿½åŠ ã€** ã‚’ã‚¯ãƒªãƒƒã‚¯

#### 5.3 www ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚‚è¿½åŠ ï¼ˆæ¨å¥¨ï¼‰

åŒã˜æ‰‹é †ã§ **`www.nagai-shouten.com`** ã‚‚è¿½åŠ ã—ã¾ã™ã€‚

> **ğŸ’¡ Tips**: www ã‚ã‚Šã¨ www ãªã—ã®ä¸¡æ–¹ã‚’è¨­å®šã™ã‚‹ã¨ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã©ã¡ã‚‰ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚‚å‹•ä½œã—ã¾ã™ã€‚

#### 5.4 DNS è¨­å®šï¼ˆè‡ªå‹•ï¼‰

Cloudflare Registrar ã¾ãŸã¯ Cloudflare ã§ç®¡ç†ã—ã¦ã„ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã®å ´åˆã€DNS ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯ **è‡ªå‹•çš„ã«è¨­å®š** ã•ã‚Œã¾ã™ã€‚

ä»¥ä¸‹ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒè‡ªå‹•è¿½åŠ ã•ã‚Œã¾ã™ï¼š

| Type | Name | Content | Proxy |
|------|------|---------|-------|
| CNAME | @ | nagai-shouten.nagai-shouten.workers.dev | Proxied (ã‚ªãƒ¬ãƒ³ã‚¸ã‚¯ãƒ©ã‚¦ãƒ‰) |
| CNAME | www | nagai-shouten.nagai-shouten.workers.dev | Proxied (ã‚ªãƒ¬ãƒ³ã‚¸ã‚¯ãƒ©ã‚¦ãƒ‰) |

---

## å‹•ä½œç¢ºèª

### Step 6: ãƒ‡ãƒ—ãƒ­ã‚¤ç¢ºèª

#### 6.1 HTTPS ã‚¢ã‚¯ã‚»ã‚¹ç¢ºèª

```bash
# ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±ã‚’å–å¾—
curl -I https://nagai-shouten.com
```

**æ­£å¸¸ãªå‡ºåŠ›ä¾‹**:
```
HTTP/2 200
date: Wed, 08 Jan 2026 12:00:00 GMT
content-type: text/html; charset=utf-8
server: cloudflare
cf-ray: 123456789abcdef-NRT
```

#### 6.2 ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹

```bash
# macOS ã®å ´åˆ
open https://nagai-shouten.com

# Linux ã®å ´åˆ
xdg-open https://nagai-shouten.com

# Windows ã®å ´åˆ
start https://nagai-shouten.com
```

#### 6.3 ä¸»è¦ãƒšãƒ¼ã‚¸ã®ç¢ºèª

ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ãŒæ­£å¸¸ã«è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªï¼š

- [x] ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸: `https://nagai-shouten.com/`
- [x] ã‚µãƒ¼ãƒ“ã‚¹ãƒšãƒ¼ã‚¸: `https://nagai-shouten.com/services`
- [x] ãŠå•ã„åˆã‚ã›: `https://nagai-shouten.com/contact`
- [x] ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸: `https://nagai-shouten.com/login`

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### å•é¡Œ 1: `ENOTEMPTY` ã‚¨ãƒ©ãƒ¼

**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**:
```
Error: ENOTEMPTY, Directory not empty: .open-next
```

**åŸå› **: æ—¢å­˜ã®ãƒ“ãƒ«ãƒ‰æˆæœç‰©ãŒæ®‹ã£ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•**:
```bash
# ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã‚’å‰Šé™¤
rm -rf .open-next .next

# å†åº¦ãƒ‡ãƒ—ãƒ­ã‚¤
npm run deploy:production
```

---

#### å•é¡Œ 2: èªè¨¼ã‚¨ãƒ©ãƒ¼

**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**:
```
Error: Not logged in. Please run wrangler login
```

**è§£æ±ºæ–¹æ³•**:
```bash
# å†èªè¨¼
wrangler login

# èªè¨¼ç¢ºèª
wrangler whoami
```

---

#### å•é¡Œ 3: ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒåæ˜ ã•ã‚Œãªã„

**ç—‡çŠ¶**: ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¿½åŠ ã—ãŸãŒã€ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„

**åŸå› **: DNS ä¼æ’­ã«æ™‚é–“ãŒã‹ã‹ã£ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•**:

1. **DNS ä¼æ’­ã‚’ç¢ºèª**:
   ```bash
   # nslookup ã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ç¢ºèª
   nslookup nagai-shouten.com
   ```

2. **å¾…æ©Ÿ**: é€šå¸¸ã¯æ•°åˆ†ã€œ15åˆ†ã§åæ˜ ã•ã‚Œã¾ã™ï¼ˆæœ€å¤§48æ™‚é–“ï¼‰

3. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢**:
   ```bash
   # DNS ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ï¼ˆmacOSï¼‰
   sudo dscacheutil -flushcache; sudo killall -HUP mDNSResponder

   # DNS ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢ï¼ˆWindowsï¼‰
   ipconfig /flushdns
   ```

---

#### å•é¡Œ 4: ç’°å¢ƒå¤‰æ•°ãŒåæ˜ ã•ã‚Œãªã„

**ç—‡çŠ¶**: `AUTH_SECRET` ãªã©ã®ç’°å¢ƒå¤‰æ•°ãŒæ©Ÿèƒ½ã—ãªã„

**ç¢ºèªæ–¹æ³•**:
```bash
# è¨­å®šæ¸ˆã¿ç’°å¢ƒå¤‰æ•°ã‚’ç¢ºèª
wrangler secret list --env production
```

**è§£æ±ºæ–¹æ³•**:
```bash
# ç’°å¢ƒå¤‰æ•°ã‚’å†è¨­å®š
wrangler secret put AUTH_SECRET --env production
wrangler secret put AUTH_URL --env production

# å†ãƒ‡ãƒ—ãƒ­ã‚¤
npm run deploy:production
```

---

#### å•é¡Œ 5: ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼

**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**:
```
Error: Build failed
```

**ç¢ºèªæ–¹æ³•**:
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸã™ã‚‹ã‹ç¢ºèª
npm run build

# å‹ãƒã‚§ãƒƒã‚¯
npm run lint
```

**è§£æ±ºæ–¹æ³•**:
1. ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª
2. TypeScript ã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£
3. ä¾å­˜é–¢ä¿‚ã‚’ç¢ºèª: `npm install`
4. å†åº¦ãƒ‡ãƒ—ãƒ­ã‚¤

---

## è£œè¶³æƒ…å ±

### ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç„¡åŠ¹åŒ–ï¼ˆæ¨å¥¨ï¼‰

æœ¬ç•ªç’°å¢ƒã§ã¯ã€é–‹ç™ºç”¨ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/lib/auth/test-data.ts`

```typescript
// æœ¬ç•ªç’°å¢ƒã§ã¯ç©ºé…åˆ—ã‚’è¿”ã™
export const TEST_USERS =
	process.env.NODE_ENV === "production" ? [] : [
		{
			id: "1",
			email: "user@example.com",
			// ...
		},
	];
```

### ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œã€ä»¥ä¸‹ã‚’ç¢ºèªï¼š

1. **Lighthouse ã‚¹ã‚³ã‚¢**:
   - Chrome DevTools ã§ Performance ã‚’æ¸¬å®š
   - ç›®æ¨™: Performance 90 ä»¥ä¸Š

2. **Core Web Vitals**:
   - LCP (Largest Contentful Paint): < 2.5s
   - FID (First Input Delay): < 100ms
   - CLS (Cumulative Layout Shift): < 0.1

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [x] AUTH_SECRET ãŒæœ¬ç•ªç”¨ã«ç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
- [x] ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹
- [x] HTTPS ãŒæœ‰åŠ¹ï¼ˆCloudflare è‡ªå‹•ï¼‰
- [x] CSP ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ï¼ˆmiddleware ã§å®Ÿè£…æ¸ˆã¿ï¼‰

### ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š

Cloudflare Workers ã®æ–™é‡‘ï¼ˆ2026å¹´1æœˆç¾åœ¨ï¼‰:

- **Free ãƒ—ãƒ©ãƒ³**: 100,000 ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æ—¥ï¼ˆç„¡æ–™ï¼‰
- **Paid ãƒ—ãƒ©ãƒ³**: $5/æœˆ + $0.50/ç™¾ä¸‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆ

> **ğŸ’° Tips**: å€‹äººã‚µã‚¤ãƒˆã‚„å°è¦æ¨¡ãƒ“ã‚¸ãƒã‚¹ãªã‚‰ Free ãƒ—ãƒ©ãƒ³ã§ååˆ†ã§ã™ã€‚

---

## å‚è€ƒãƒªãƒ³ã‚¯

- [Cloudflare Workers å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://developers.cloudflare.com/workers/)
- [OpenNext Cloudflare ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼](https://opennext.js.org/cloudflare)
- [Next.js 15 ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰](https://nextjs.org/docs/app/building-your-application/deploying)
- [Wrangler CLI ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹](https://developers.cloudflare.com/workers/wrangler/)

---

## ã¾ã¨ã‚

ã“ã®ã‚¬ã‚¤ãƒ‰ã«å¾“ã†ã“ã¨ã§ã€Next.js 15 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ Cloudflare Workers ã«æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã—ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³ã§å…¬é–‹ã§ãã¾ã™ã€‚

### ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [x] Worker åã‚’è¨­å®š
- [x] wrangler èªè¨¼å®Œäº†
- [x] AUTH_SECRET ã¨ AUTH_URL ã‚’è¨­å®š
- [x] ãƒ“ãƒ«ãƒ‰ & ãƒ‡ãƒ—ãƒ­ã‚¤æˆåŠŸ
- [x] ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¿½åŠ 
- [x] HTTPS ã‚¢ã‚¯ã‚»ã‚¹ç¢ºèª
- [x] ä¸»è¦ãƒšãƒ¼ã‚¸ã®å‹•ä½œç¢ºèª
- [x] ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç„¡åŠ¹åŒ–ï¼ˆæ¨å¥¨ï¼‰

---

**æ›´æ–°å±¥æ­´**:
- 2026-01-08: åˆç‰ˆä½œæˆï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †å®Œå…¨ã‚¬ã‚¤ãƒ‰ï¼‰
